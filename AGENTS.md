# AGENT HANDBOOK

## 1. Tech Stack & Layout
- Next.js 15 App Router with TypeScript, Tailwind CSS 4, shadcn/ui, Fuse.js search, Katex, and Zustand stores; run with `yarn dev`, `yarn build`, `yarn lint`, `yarn test`, or Docker (`docker:compose`) as defined in `package.json:5`.
- The root layout loads markdown-powered meta text, wraps every page in the theme + tooltip providers, injects the sticky navbar/footer, and pulls Vercel analytics; any global provider belongs in `Providers` (`app/layout.tsx:28`, `providers/Providers.tsx:13`, `providers/VercelTrackers.tsx:1`).
- Global styles rely on Tailwind's new `@import "tailwindcss"` syntax with custom typography utilities and KaTeX styles, so keep custom classes consistent with the design tokens defined in `app/globals.css:1`.

## 2. Static Database Model
- All “database” modules expose a dictionary typed by enums such as `ProjectDatabaseKeys`, `SkillDatabaseKeys`, etc.; each entry must satisfy `MaterialInterface` or a subtype (`database/Materials/MaterialInterface.ts:1`, `database/Skills/SkillInterface.ts:1`).
- `materialDatabaseMap` merges every material collection (projects, courses, roles, modules, certificates, blogs) and precomputes `skillUsageMap` for O(1) skill lookups; update this aggregator if you introduce a new top-level material type (`database/Materials/MaterialDatabaseMap.ts:1`).
- Skill propagation helpers (e.g., `addNestedSkillsMaterialList`) automatically append related general/soft skills to materials; make sure `SkillInterface.relatedSkills` lists are accurate for auto-enrichment to work (`actions/material/addNestedSkillsMaterialList.ts:1`).

## 3. Static Assets & Slugs
- Enum values double as URL slugs and folder names. For example, every project slug must have a matching folder in `public/projects/<slug>` with `cover.png`, optional `/media` images/videos for galleries, `features.md`, `blog.md`, and `/img` assets for reports (`database/Projects/ProjectDatabaseKeys.ts:1`, `app/projects/[projectKey]/page.tsx:118`).
- Blog markdown lives in `public/blogs/<slug>/blog.md` (or under `public/projects/<slug>/blog.md` for project write-ups). All markdown images should use the `{BASE}` placeholder so `processMarkdownImages` can rewrite them to `/blogs/<slug>/img` or `/projects/<slug>/img` at runtime (`public/blogs/README.txt:1`, `app/blogs/[blogKey]/page.tsx:86`, `actions/processMarkdownImages.ts:1`).
- Certificates expect `/public/certificates/<slug>.jpg`, courses/modules expect `/public/education/<course>/logo.png` (and optional `certificate.jpg`), roles expect `/public/roles/<slug>/responsabilities.md`, companies expect `/public/companies/<key>/logo.png`, and the about pages consume `public/about/short.md` + `public/about/long.md` (`app/certificates/[certificateKey]/page.tsx:91`, `database/Courses/CourseDatabaseMap.ts:16`, `app/experience/[roleKey]/page.tsx:187`, `actions/material/experience/addCompanyThumbnail.ts:1`, `app/(site)/components/AboutSection/AboutSection.tsx:21`, `app/about/page.tsx:23`).

## 4. Adding or Updating Content
- **Projects:** Add a slug to `ProjectDatabaseKeys`, create the entry in `ProjectDatabaseMap` with `skills`, `category`, `type`, links, and any `relatedMaterials`, then create the `public/projects/<slug>` assets; the detail page automatically renders galleries, features, report links, and related material if those files exist (`database/Projects/ProjectDatabaseKeys.ts:1`, `app/projects/[projectKey]/page.tsx:137`, `app/projects/[projectKey]/_components/ProjectLinks.tsx:25`, `app/projects/[projectKey]/report/page.tsx:22`).
- **Blogs:** Register the key in `database/Blogs`, supply the markdown folder (with `{BASE}` image paths) under `public/blogs/<slug>` unless it mirrors a project, and optionally list `relatedMaterials` so the Material tab can surface cross-links (`database/Blogs/BlogsDatabaseMap.ts:1`, `app/blogs/[blogKey]/page.tsx:86`).
- **Certificates:** Update `CertificateDatabaseKeys`/map, drop the certificate image at `/public/certificates/<slug>.jpg`, and ensure issuer/learning outcomes/skills are populated; the detail page will render issuer tags, skill tables, and related material automatically (`app/certificates/[certificateKey]/page.tsx:91`).
- **Courses & Modules:** Define modules in `database/Modules/ModuleDatabaseMap` (with `parentCourse`, `learningOutcomes`, `skills`, `relatedMaterials`), reference them from `CourseDatabaseMap`, and supply logos/certificates in `/public/education`. Aggregators recalc skills and related material per course, so no manual duplication is necessary (`database/Modules/ModuleDatabaseMap.ts:1`, `database/Courses/CourseDatabaseMap.ts:103`).
- **Roles & Companies:** Add new companies (logo + metadata) and roles, including `ShortDate` start/end, `skills`, `relatedMaterials`, and the slugged markdown for responsibilities. The role page reads `public/roles/<slug>/responsabilities.md`, pulls company logos, and reuses `MaterialList` for related work (`database/Roles/RoleDatabaseMap.ts:1`, `app/experience/[roleKey]/page.tsx:186`).
- **Skills:** Extend `SkillDatabaseKeys` + `SkillDatabaseMap` with proper `category`, `skillType`, `isMainSkill`, and `relatedSkills`. Those relationships drive nested skill propagation, the homepage language modal, filtering, and the skill detail’s “Related Skills” table (`database/Skills/SkillInterface.ts:1`, `actions/skills/group/buildSkillTableGroups.ts:1`).

## 5. Related Material & Skill Surfacing
- `MaterialList` + `MaterialTab` split a set of material keys into tabbed sections for projects, roles, modules, certificates, and blogs; keep `MaterialTypeEnum` + `MaterialTab` in sync if you add new material types (`components/MaterialLists/MaterialList.tsx:12`, `components/MaterialLists/MaterialTab.tsx:72`, `enums/Material/MaterialTypeEnum.ts:1`).
- Section lists such as `ProjectsList`, `WorkList`, `BlogsList`, etc., all share `MaterialGroupSectionList`, which skips the “All” bucket by default and expects meaningful `category` values on your materials (`components/MaterialLists/MaterialGroupSectionList.tsx:23`).
- Skill displays rely on `SkillTableSection` + `CategorySkillDisplay` and the `buildSkillTableGroups` helper; ensure new materials list tech/general/soft skills so tabs are not empty (`actions/skills/group/buildSkillTableGroups.ts:1`, `components/Skills/SkillTableSection.tsx:1`).
- `SkillTag` only links to `/skills/<slug>` when `isSkillAssociatedWithMaterial` returns true (i.e., the skill appears in at least one material), and the “Hide skills without material” filter hides tags with <2 references via `skillHasMaterial` (`components/Tags/SkillTag.tsx:27`, `actions/material/skillHasMaterial.tsx:1`, `actions/material/countMaterialsBySkill.ts:1`).

## 6. Filters, Search & URL State
- Listing pages (`ProjectsView`, `ExperienceView`, `CertificatesView`, `BlogsView`) all inject filters via the generic `useMaterialFilterState` hook. To introduce new filter dimensions, add a config object with `sectionName`, `urlParam`, `options`, and an `applyFilter` that returns the filtered key array; the hook handles reading URL params, running Fuse search, grouping categories, and wiring the archive toggle (`hooks/useMaterialFilterState.ts:1`, `app/projects/components/ProjectsView.tsx:36`).
- `FilterSection` renders the accordion, search box, “Filters” drawer button, clear-all link, and archive toggle; it always rebuilds the URL via `generateUrl`, so keep query param names stable and lowercase-friendly (`components/Filters/FilterSection.tsx:35`, `actions/generateUrl.ts:1`).
- Fuzzy search uses Fuse.js wrappers (`useFuseMaterialSearch`, `useFuseSkillSearch`), which currently map any `skills.*` key to the skill slug strings; if you add deeply nested fields, extend `getFn` accordingly (`hooks/useFuseSearch/useFuseMaterialSearch.tsx:1`, `hooks/useFuseSearch/useFuseSkillSearch.tsx:1`).
- The `GlobalSearch` command palette is a curated list of pages, materials, modules, and socials. Whenever you add new top-level destinations, ensure this component and `NAV_ITEMS` surface them so Ctrl/Cmd+K navigation stays exhaustive (`components/GlobalSearch/SearchButton.tsx:1`, `constants/pages.ts:1`).

## 7. Markdown, Galleries & Media
- File-system helpers (`getMarkdownFromFileSystem`, `getImagesFromFileSystem`, `getVideosFromFileSystem`) back every content-heavy page; missing files simply render empty sections, so verify assets exist and are Git-tracked (`actions/file-system/getMarkdownFromFileSystem.ts:1`, `actions/file-system/getImagesFromFileSystem.ts:1`).
- Project pages look for `/media` assets to build galleries, fall back to `/cover.png`, load `features.md`, and expose report links if `blog.md` exists. The report route is a separate page that reuses `SpecialReader` to show a table of contents and rewrites `{BASE}` image paths (`app/projects/[projectKey]/page.tsx:137`, `app/projects/[projectKey]/report/page.tsx:22`).
- Blog and report markdown render through the `Reader`/`SpecialReader` components, which support inline/block KaTeX and optional contents drawers; headings in the markdown control the generated table of contents (`components/Reader/Reader.tsx:1`, `components/Reader/SpecialReader.tsx:1`).

## 8. SEO, Navigation & UX
- Every dynamic route implements `generateMetadata` and `generateStaticParams`; mirror the existing patterns when adding new pages so SEO keywords are populated and 404s guard missing data (`app/projects/[projectKey]/page.tsx:60`, `app/skills/[skillKey]/page.tsx:31`).
- `constants/pages` defines canonical labels/paths/descriptions for navigation, SEO copy, the navbar, and the “More” index page; update it whenever routes change so `Navbar`, `GlobalSearch`, and `PageNavigationItem` stay consistent (`constants/pages.ts:1`, `app/more/page.tsx:1`).
- `app/robots.ts` and `app/sitemap.ts` both derive `baseUrl` from `NEXT_PUBLIC_SITE_URL`; remember to set that env var in production/staging builds, and extend the disallow/sitemap lists if you introduce new routes that should be hidden or indexed (`app/robots.ts:11`, `app/sitemap.ts:11`).
- Client-only helpers like `Scroll`, `useMediaQuery`, and the navbar Zustand store are already wired up; if you build new interactive components, reuse these utilities rather than re-implementing them (`components/UI/Scroll.tsx:1`, `hooks/useMediaQuery.tsx:1`, `hooks/useNavbarStore.ts:1`).

## 9. Tooling & Commands
- Primary scripts: `yarn dev` (Turbopack), `yarn build`, `yarn start`, `yarn lint`, `yarn test`, `yarn test:coverage`, plus `docker-compose -f docker/docker-compose.yml up --build` for containerized runs; coverage thresholds are enforced at 80% via Vitest (`package.json:5`, `vitest.config.ts:4`).
- The Dockerfile performs a two-stage build on Node 20 Alpine and runs `yarn build` before copying `.next` + `public`, so ensure any runtime assets live under `public` or are produced during `yarn build` (`docker/next/Dockerfile:1`).
- Image optimization settings live in `next.config.js`, and Tailwind utilities rely on PostCSS 8; test responsive changes in both light/dark themes provided by `next-themes` (`next.config.js:1`).

## 10. Gotchas & Tips
- Because `skillUsageMap` is computed at module load time, restarting the dev server (or invalidating the module cache) is required after changing any `skills` arrays to keep association counts accurate (`database/Materials/MaterialDatabaseMap.ts:26`).
- Archive toggles default to hiding archived entries; search/filter actions force `archived=true` in URLs so you can discover historical material, so respect the `archived` flag on any new entries (`components/Filters/FilterSection.tsx:57`).
- `MaterialGroupSectionList` ignores groups named “All” by default; if you need an all-in-one bucket, override `shouldRenderGroup` when invoking the component (`components/MaterialLists/MaterialGroupSectionList.tsx:23`).
- The command palette, homepage sections (hero subtitles, featured projects), and About page featured materials are all hard-coded arrays—remember to refresh those curated lists when you highlight new work (`app/(site)/components/HeroSection.tsx:1`, `app/(site)/components/ProjectSection.tsx:21`, `app/about/page.tsx:65`).
- Blog front matter (title/subtitle/date/display) is documented in `public/blogs/README.txt:1`; follow that template so future automation can parse metadata consistently.
- Responsibilities markdown filenames are spelled `responsabilities.md`; keep that spelling when creating new role folders so the role page resolves the file without change (`app/experience/[roleKey]/page.tsx:186`).
